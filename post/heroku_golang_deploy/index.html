<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Hugo 0.55.6" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="damao" />
  <meta property="og:url" content="https://simpleowen.github.io/post/heroku_golang_deploy/" />
  <link rel="canonical" href="https://simpleowen.github.io/post/heroku_golang_deploy/" /><script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "https:\/\/simpleowen.github.io\/"
      },
      "articleSection" : "post",
      "name" : "将 Golang 程序部署到 Heroku",
      "headline" : "将 Golang 程序部署到 Heroku",
      "description" : "环境 macOS git Golang 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \/\/ main.go package main import ( \x26#34;log\x26#34; \x26#34;net\/http\x26#34; \x26#34;os\x26#34; ) func hello(w http.ResponseWriter, r *http.Request) { w.Write([]byte(\x26#34;hello.world\x26#34;)) } func main() { http.HandleFunc(\x26#34;\/hello\x26#34;, hello) \/\/err := http.ListenAndServe(\x26#34;:8080\x26#34;, nil) err := http.ListenAndServe(\x26#34;:\x26#34; \x2b os.Getenv(\x26#34;PORT\x26#34;), nil) if err != nil { log.Fatal(err) } }",
      "inLanguage" : "en-US",
      "author" : "damao",
      "creator" : "damao",
      "publisher": "damao",
      "accountablePerson" : "damao",
      "copyrightHolder" : "damao",
      "copyrightYear" : "2019",
      "datePublished": "2019-05-29 12:21:52 -0400 EDT",
      "dateModified" : "2019-05-29 12:21:52 -0400 EDT",
      "url" : "https:\/\/simpleowen.github.io\/post\/heroku_golang_deploy\/",
      "keywords" : [ "Heroku","部署", ]
  }
</script>
<title>将 Golang 程序部署到 Heroku - 我坦白~</title>
  <meta property="og:title" content="将 Golang 程序部署到 Heroku - 我坦白~" />
  <meta property="og:type" content="article" />
  <meta name="description" content="环境 macOS git Golang 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // main.go package main import ( &#34;log&#34; &#34;net/http&#34; &#34;os&#34; ) func hello(w http.ResponseWriter, r *http.Request) { w.Write([]byte(&#34;hello.world&#34;)) } func main() { http.HandleFunc(&#34;/hello&#34;, hello) //err := http.ListenAndServe(&#34;:8080&#34;, nil) err := http.ListenAndServe(&#34;:&#34; &#43; os.Getenv(&#34;PORT&#34;), nil) if err != nil { log.Fatal(err) } }" />

  <link rel="stylesheet" href="https://unpkg.com/flexboxgrid@6.3.1/dist/flexboxgrid.min.css" />
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/tomorrow.min.css" />
  <link rel="stylesheet" href="/css/index.css">
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="我坦白~">
  
  <link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker" rel="stylesheet">
  
  <script>
    

    (function (undefined) { }).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});
  </script>

  
</head>

<body>
  <article class="post " id="article">
    <div class="row">
      <div class="col-xs-12 col-sm-10 col-md-8 col-sm-offset-1 col-md-offset-2 col-lg-6 col-lg-offset-3">
        <div class="site-header">
          
<header>
  <div class="signatures site-title">
    <a href="/">damao</a>
  </div>
</header>
<div class="row end-xs">
  
  
</div>
<div class="header-line"></div>

        </div>
        <header class="post-header">
          <h1 class="post-title">将 Golang 程序部署到 Heroku</h1>
          <div class="row">
            <div class="col-xs-6">
              <time class="post-date" datetime="2019-05-29 12:21:52 EDT">
                29, May, 2019
              </time>
            </div>
            <div class="col-xs-6">
              <div class="post-author">
                <a target="_blank" href="">@damao</a>
              </div>
            </div>
          </div>
        </header>

        <div class="post-content markdown-body">
          

<ul>
<li>环境

<ul>
<li>macOS</li>
<li>git</li>
<li>Golang 代码</li>
</ul></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go">    <span class="c1">// main.go
</span><span class="c1"></span>
    <span class="kn">package</span> <span class="nx">main</span>

    <span class="kn">import</span> <span class="p">(</span>
        <span class="s">&#34;log&#34;</span>
        <span class="s">&#34;net/http&#34;</span>
        <span class="s">&#34;os&#34;</span>
    <span class="p">)</span>

    <span class="kd">func</span> <span class="nf">hello</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;hello.world&#34;</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/hello&#34;</span><span class="p">,</span> <span class="nx">hello</span><span class="p">)</span>
    <span class="c1">//err := http.ListenAndServe(&#34;:8080&#34;, nil) 
</span><span class="c1"></span>        <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="s">&#34;:&#34;</span> <span class="o">+</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;PORT&#34;</span><span class="p">),</span> <span class="kc">nil</span><span class="p">)</span> 
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li>前提

<ul>
<li>创建一个 heroku 账户</li>
<li>安装 heroku 命令行工具</li>
<li>安装 heroku 命令行</li>
<li>运行 <code>brew install heroku/brew/heroku</code> 命令</li>
<li>验证安装</li>
<li>运行 <code>heroku</code> 命令</li>
</ul></li>
</ul>

<h2 id="步骤">步骤</h2>

<ul>
<li><p>命令行登录</p>

<ul>
<li><p>运行 <code>heroku login</code> 命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">heroku: Press any key to open up the browser to login or q to exit:
Opening browser to https://cli-auth.heroku.com/auth/browser/865fec7b-8b18-4080-82c8-1fe695b1322c
Logging in... done
Logged in as xxx@yyyy.com</pre></td></tr></table>
</div>
</div></li>
</ul></li>

<li><p>将 golang 代码所在目录初始化为 git 仓库，并提交内容</p>

<ul>
<li>git init</li>
<li>git add</li>
<li>git commit</li>
</ul></li>

<li><p>运行 <code>heroku create</code> 命令，创建 heroku app ,并与远程 heroku 仓库建立链接</p></li>

<li><p>推送本地内容到远程 heroku 仓库</p>

<ul>
<li>git push heroku master</li>
</ul></li>

<li><p>部署完成，<a href="https://evening-tundra-19792.herokuapp.com/hello">https://evening-tundra-19792.herokuapp.com/hello</a></p></li>
</ul>

<h2 id="坑">坑</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">State changed from starting to crashed
State changed from crashed to starting
Error R10 (Boot timeout) -&gt; Web process failed to bind to $PORT within 60 seconds of launch</pre></td></tr></table>
</div>
</div>
<ul>
<li>heroku 不需要你绑定固定的端口号, 它会自动绑定 $PORT 环境变量</li>
<li>可查看本文开头的代码</li>
</ul>

<h2 id="refs">refs</h2>

<ul>
<li><a href="https://devcenter.heroku.com/articles/getting-started-with-go">Getting Started on Heroku with Go | Heroku Dev Center</a></li>
<li><a href="https://devcenter.heroku.com/articles/preparing-a-codebase-for-heroku-deployment">Preparing a Codebase for Heroku Deployment | Heroku Dev Center</a></li>
<li><a href="https://devcenter.heroku.com/articles/git#creating-a-heroku-remote">Deploying with Git | Heroku Dev Center</a></li>
<li><a href="https://devcenter.heroku.com/articles/error-codes">Heroku Error Codes | Heroku Dev Center</a></li>
<li><a href="https://stackoverflow.com/questions/32463004/heroku-go-app-crashing">Heroku Go app crashing - Stack Overflow</a></li>
</ul>

        </div>
        
        
        
        <div class="site-footer">
  
  <div class="site-footer-item">
    <a href="https://github.com/joway/hugo-theme-yinyang" target="_blank">Theme</a>
  </div>
</div>

      </div>
    </div>
  </article>

  <script src="/js/highlight.pack.js"></script>
<script src="https://unpkg.com/quicklink@0.1.1/dist/quicklink.umd.js"></script>

<script>
  hljs.initHighlightingOnLoad();
  
  var posts = document.getElementById('posts-list');
  posts && quicklink({
    el: posts,
    priority: true,
  });
</script>

  

</body>

</html>